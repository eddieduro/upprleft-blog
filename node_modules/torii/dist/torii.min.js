define("torii/adapters/application",["exports"],function(a){"use strict";var b=Ember.Object.extend({open:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `open` for a session to be opened")})},fetch:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `fetch` for a session to be fetched")})},close:function(){return new Ember.RSVP.Promise(function(){throw new Error("The Torii adapter must implement `close` for a session to be closed")})}});a["default"]=b}),define("torii/bootstrap/routing",["torii/routing/application-route-mixin","torii/routing/authenticated-route-mixin","torii/lib/container-utils","exports"],function(a,b,c,d){"use strict";function e(a,b,c){var d,e=h(a,b);e?e.reopen(c):(d=i(a,"route:basic"),k||(k=d.extend(g)),j(a,b,k))}var f=a["default"],g=b["default"],h=c.lookup,i=c.lookupFactory,j=c.register,k=null;d["default"]=function(a,b){e(a,"route:application",f);for(var c=0;c<b.length;c++){var d=b[c],h="route:"+d;e(a,h,g)}}}),define("torii/bootstrap/session",["torii/services/torii-session","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=function(a,b){var d="service:"+b;a.register(d,c),a.inject(d,"torii","service:torii"),a.inject("route",b,d),a.inject("controller",b,d)}}),define("torii/bootstrap/torii",["torii/providers/linked-in-oauth2","torii/providers/google-oauth2","torii/providers/google-oauth2-bearer","torii/providers/facebook-connect","torii/providers/facebook-oauth2","torii/adapters/application","torii/providers/twitter-oauth1","torii/providers/github-oauth2","torii/providers/azure-ad-oauth2","torii/providers/stripe-connect","torii/providers/edmodo-connect","torii/services/torii","torii/services/popup","torii/lib/container-utils","exports"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p=a["default"],q=b["default"],r=c["default"],s=d["default"],t=e["default"],u=f["default"],v=g["default"],w=h["default"],x=i["default"],y=j["default"],z=k["default"],A=l["default"],B=m["default"],C=n.hasRegistration;o["default"]=function(a){if(a.register("service:torii",A),a.register("torii-provider:linked-in-oauth2",p),a.register("torii-provider:google-oauth2",q),a.register("torii-provider:google-oauth2-bearer",r),a.register("torii-provider:facebook-connect",s),a.register("torii-provider:facebook-oauth2",t),a.register("torii-provider:twitter",v),a.register("torii-provider:github-oauth2",w),a.register("torii-provider:azure-ad-oauth2",x),a.register("torii-provider:stripe-connect",y),a.register("torii-provider:edmodo-connect",z),a.register("torii-adapter:application",u),a.register("torii-service:popup",B),a.inject("torii-provider","popup","torii-service:popup"),window.DS){var b="store:main";C(a,"service:store")&&(b="service:store"),a.inject("torii-provider","store",b),a.inject("torii-adapter","store",b)}}}),define("torii/configuration",["exports"],function(a){"use strict";function b(a,b){return Ember.computed(function(){this._super=this._super||function(){throw new Error("should always have _super")}();var e=this.get("configNamespace"),f=e?[e,a].join("."):a,g=c(d,f);if("undefined"==typeof g){if("undefined"!=typeof b)return"function"==typeof b?b.call(this):b;throw new Error("Expected configuration value "+f+" to be defined!")}return g})}var c=Ember.get,d=c(window,"ENV.torii")||{};d.providers=d.providers||{},a.configurable=b,a["default"]=d}),define("torii/initializers/initialize-torii-callback",["torii/redirect-handler","exports"],function(a,b){"use strict";var c=a["default"];b["default"]={name:"torii-callback",before:"torii",initialize:function(a){arguments[1]&&(a=arguments[1]),a.deferReadiness(),c.handle(window)["catch"](function(){a.advanceReadiness()})}}}),define("torii/initializers/initialize-torii-session",["torii/configuration","torii/bootstrap/session","exports"],function(a,b,c){"use strict";var d=a["default"],e=b["default"];c["default"]={name:"torii-session",after:"torii",initialize:function(a){if(arguments[1]&&(a=arguments[1]),d.sessionServiceName){e(a,d.sessionServiceName);var b="service:"+d.sessionServiceName;a.inject("adapter",d.sessionServiceName,b)}}}}),define("torii/initializers/initialize-torii",["torii/bootstrap/torii","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=(b["default"],{name:"torii",initialize:function(a){arguments[1]&&(a=arguments[1]),d(a),a.inject("route","torii","service:torii")}});window.DS&&(e.after="store"),c["default"]=e}),define("torii/instance-initializers/setup-routes",["torii/configuration","torii/bootstrap/routing","torii/router-dsl-ext","exports"],function(a,b,c,d){"use strict";var e=a["default"],f=b["default"];d["default"]={name:"torii-setup-routes",initialize:function(a,b){if(e.sessionServiceName){var c=a.get("router"),d=function(){var b=c.router.authenticatedRoutes,e=!Ember.isEmpty(b);e&&f(a,b),c.off("willTransition",d)};c.on("willTransition",d)}}}}),define("torii/instance-initializers/walk-providers",["torii/configuration","torii/lib/container-utils","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.lookup;c["default"]={name:"torii-walk-providers",initialize:function(a){for(var b in d.providers)d.providers.hasOwnProperty(b)&&e(a,"torii-provider:"+b)}}}),define("torii/lib/container-utils",["exports"],function(a){"use strict";function b(a,b){return a&&a.hasRegistration?a.hasRegistration(b):a.registry.has(b)}function c(a,b,c){return a&&a.application?a.application.register(b,c):a.registry.register(b,c)}function d(a,b){return a&&a.lookupFactory?a.lookupFactory(b):a&&a.application?a.application.__container__.lookupFactory(b):a.container.lookupFactory(b)}function e(a,b){return a&&a.lookup?a.lookup(b):a&&a.application?a.application.__container__.lookup(b):a.container.lookup(b)}a.hasRegistration=b,a.register=c,a.lookupFactory=d,a.lookup=e}),define("torii/lib/load-initializer",["exports"],function(a){"use strict";a["default"]=function(a){Ember.onLoad("Ember.Application",function(b){b.initializer(a)})}}),define("torii/lib/load-instance-initializer",["exports"],function(a){"use strict";a["default"]=function(a){Ember.onLoad("Ember.Application",function(b){b.instanceInitializer(a)})}}),define("torii/lib/parse-query-string",["exports"],function(a){"use strict";a["default"]=Ember.Object.extend({init:function(){this.validKeys=this.keys},parse:function(){for(var a=this.url,b=this.validKeys,c={},d=0;d<b.length;d++){var e=b[d],f=new RegExp(e+"=([^&#]*)"),g=f.exec(a);g&&(c[e]=g[1])}return c}})}),define("torii/lib/popup-id-serializer",["exports"],function(a){"use strict";var b={serialize:function(a){return"torii-popup:"+a},deserialize:function(a){if(!a)return null;var b=a.match(/^(torii-popup:)(.*)/);return b?b[2]:null}};a["default"]=b}),define("torii/lib/query-string",["exports"],function(a){"use strict";function b(a){return a||a===!1}function c(a,c,d){var g=e(c),h=f(a,g);if(!d){if(!b(h)&&b(f(a,c)))throw new Error('Use camelized versions of url params. (Did not find "'+g+'" property but did find "'+c+'".');if(!b(h))throw new Error('Missing url param: "'+c+'". (Looked for: property named "'+g+'".')}return b(h)?encodeURIComponent(h):void 0}function d(a,b){return c(a,b,!0)}var e=Ember.String.camelize,f=Ember.get;a["default"]=Ember.Object.extend({init:function(){this.obj=this.provider,this.urlParams=Ember.A(this.requiredParams).uniq(),this.optionalUrlParams=Ember.A(this.optionalParams||[]).uniq(),this.optionalUrlParams.forEach(function(a){if(this.urlParams.indexOf(a)>-1)throw new Error("Required parameters cannot also be optional: '"+a+"'")},this)},toString:function(){var a=this.urlParams,e=this.optionalUrlParams,f=this.obj,g=Ember.A([]);return a.forEach(function(a){var b=c(f,a);g.push([a,b])}),e.forEach(function(a){var c=d(f,a);b(c)&&g.push([a,c])}),g.map(function(a){return a.join("=")}).join("&")}})}),define("torii/lib/random-url-safe",["exports"],function(a){"use strict";a["default"]=function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c="",d=0;a>d;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c}}),define("torii/lib/required-property",["exports"],function(a){"use strict";function b(){return Ember.computed(function(a){throw new Error("Definition of property "+a+" by a subclass is required.")})}a["default"]=b}),define("torii/lib/state-machine",["exports"],function(a){"use strict";function b(a){return a.constructor===Array?a:a?[a]:[]}function c(a){var b=a.initialState;if(this.states=a.states,!this.states)throw new Error("StateMachine needs states");if(this.state=this.states[b],!this.state)throw new Error("Missing initial state");this.currentStateName=b,this._subscriptions={};var c,d,e,f=a.beforeTransitions||[],g=a.afterTransitions||[];for(d=0,e=f.length;e>d;d++)c=f[d],this.beforeTransition.call(this,c,c.fn);for(d=0,e=g.length;e>d;d++)c=g[d],this.afterTransition.call(this,c,c.fn)}function d(a,b,c){var d;if(!b)throw new Error("invalid Transition");if(c){var f=b,g=c;d=e(f,g)}else{if(b.constructor!==Object)throw new Error("something went wrong");d=b}return d}function e(a,c){return b(a).reduce(function(a,b){return a[b]=c,a},{})}function f(a,b,c,d,e){var f=a[c];if(!(c&&d&&f)){var g="invalid transition state: "+(f&&f.currentStateName)+" from: "+c+" to: "+d;throw new Error(g)}a[c][b]=e}var g=Array.prototype.slice,h=Object.keys,i=c.SPLAT="*";c.transitionTo=function(a){return function(){this.transitionTo(a)}},c.prototype={states:{},toString:function(){return"<StateMachine currentState:'"+this.currentStateName+"' >"},transitionTo:function(a){if("."===a.charAt(0)){var b=this.currentStateName.split(".").slice(0,-1);a=0<b.length?b.join(".")+a:a.substring(1)}var c=this.states[a],d=this.currentStateName;if(!c)throw new Error("Unknown State: `"+a+"`");this.willTransition(d,a),this.state=c,this.currentStateName=a,this.didTransition(d,a)},beforeTransition:function(a,b){this._transition("willTransition",a,b)},afterTransition:function(a,b){this._transition("didTransition",a,b)},_transition:function(a,b,c){var d,e,f,g,h,j,k=b.from||i,l=b.to||i;0===l.indexOf("!")?(d=l.substr(1),h=!0):(d=l,h=!1),0===k.indexOf("!")?(e=k.substr(1),j=!0):(e=k,j=!1),g=e.indexOf(i),f=d.indexOf(i),g>=0&&(e=e.substring(g,0)),f>=0&&(d=d.substring(f,0)),this.on(a,function(a,b){var i,k,l=b,m=a;g>=0&&(m=a.substring(g,0)),f>=0&&(l=b.substring(f,0)),i=l===d!==h,k=m===e!==j,i&&k&&c.call(this,a,b)})},willTransition:function(a,b){this._notify("willTransition",a,b)},didTransition:function(a,b){this._notify("didTransition",a,b)},_notify:function(a,b,c){for(var d=this._subscriptions[a]||[],e=0,f=d.length;f>e;e++)d[e].call(this,b,c)},on:function(a,b){this._subscriptions[a]=this._subscriptions[a]||[],this._subscriptions[a].push(b)},off:function(a,b){var c=this._subscriptions[a].indexOf(b);b?c&&this._subscriptions[a].splice(c,1):this._subscriptions[a]=null},send:function(a){var b=this.state[a],c=g.call(arguments,1);return b?b.apply(this,c):void this.unhandledEvent(a)},trySend:function(a){var b=this.state[a],c=g.call(arguments,1);return b?b.apply(this,c):void 0},event:function(a,b){var e=this.states,g={transition:function(){var b=(arguments.length,arguments[0]),g=arguments[1],i=d(a,b,g);h(i).forEach(function(b){var d=i[b];f(e,a,b,d,c.transitionTo(d))})}};b.call(g)},unhandledEvent:function(a){var b=(this.currentStateName,"Unknown Event: `"+a+"` for: "+this.toString());throw new Error(b)}},a["default"]=c}),define("torii/lib/uuid-generator",["exports"],function(a){"use strict";var b={generate:function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?c:3&c|8).toString(16)});return b}};a["default"]=b}),define("torii/load-initializers",["torii/lib/load-initializer","torii/lib/load-instance-initializer","torii/initializers/initialize-torii","torii/initializers/initialize-torii-callback","torii/initializers/initialize-torii-session","torii/instance-initializers/setup-routes","torii/instance-initializers/walk-providers","exports"],function(a,b,c,d,e,f,g,h){"use strict";var i=a["default"],j=b["default"],k=c["default"],l=d["default"],m=e["default"],n=f["default"],o=g["default"];h["default"]=function(){i(l),i(k),i(m),j(o),j(n)}}),define("torii/providers/azure-ad-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=Ember.computed,g=d.extend({name:"azure-ad-oauth2",baseUrl:f(function(){return"https://login.windows.net/"+this.get("tennantId")+"/oauth2/authorize"}),tennantId:e("tennantId","common"),requiredUrlParams:["api-version","client_id"],optionalUrlParams:["scope","nonce","response_mode"],responseMode:e("responseMode",null),responseParams:f(function(){return[this.get("responseType"),"state"]}),apiVersion:"1.0",responseType:e("responseType","code"),redirectUri:e("redirectUri",function(){return this._super()})});c["default"]=g}),define("torii/providers/base",["torii/lib/required-property","exports"],function(a,b){"use strict";var c=a["default"],d=Ember.computed,e=Ember.Object.extend({name:c(),configNamespace:d("name",function(){return"providers."+this.get("name")})});b["default"]=e}),define("torii/providers/edmodo-connect",["torii/providers/oauth2-bearer","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable;c["default"]=d.extend({name:"edmodo-connect",baseUrl:"https://api.edmodo.com/oauth/authorize",responseParams:["access_token"],redirectUri:e("redirectUri"),scope:e("scope","basic")})}),define("torii/providers/facebook-connect",["torii/providers/base","torii/configuration","exports"],function(a,b,c){"use strict";function d(a){if(g)return g;var b=window.fbAsyncInit,c=a.locale;return delete a.locale,g=new Ember.RSVP.Promise(function(b,d){window.fbAsyncInit=function(){FB.init(a),Ember.run(null,b)},$.getScript("//connect.facebook.net/"+c+"/sdk.js")}).then(function(){window.fbAsyncInit=b,window.fbAsyncInit&&(window.fbAsyncInit.hasRun=!0,window.fbAsyncInit())})}function e(a,b,c){return new Ember.RSVP.Promise(function(d,e){FB.login(function(a){a.authResponse?Ember.run(null,d,a.authResponse):Ember.run(null,e,a.status)},{scope:a,return_scopes:b,auth_type:c})})}function f(a){var b={userId:a.userID,accessToken:a.accessToken,expiresIn:a.expiresIn};return a.grantedScopes&&(b.grantedScopes=a.grantedScopes),b}var g,h=a["default"],i=b.configurable,j=Ember.on,k=h.extend({name:"facebook-connect",scope:i("scope","email"),returnScopes:i("returnScopes",!1),appId:i("appId"),version:i("version","v2.2"),xfbml:i("xfbml",!1),channelUrl:i("channelUrl",null),locale:i("locale","en_US"),open:function(a){void 0===a&&(a={});var b=this.get("scope"),c=a.authType,g=this.get("returnScopes");return d(this.settings()).then(function(){return e(b,g,c)}).then(f)},settings:function(){return{status:!0,cookie:!0,xfbml:this.get("xfbml"),version:this.get("version"),appId:this.get("appId"),channelUrl:this.get("channelUrl"),locale:this.get("locale")}},loadFbLogin:j("init",function(){d(this.settings())})});c["default"]=k}),define("torii/providers/facebook-oauth2",["torii/configuration","torii/providers/oauth2-code","exports"],function(a,b,c){"use strict";var d=a.configurable,e=b["default"];c["default"]=e.extend({name:"facebook-oauth2",baseUrl:"https://www.facebook.com/dialog/oauth",requiredUrlParams:["display"],responseParams:["code","state"],scope:d("scope","email"),display:"popup",redirectUri:d("redirectUri",function(){return this._super()}),open:function(){return this._super().then(function(a){if(a.authorizationCode&&"200"===a.authorizationCode)throw new Error("User canceled authorization");return a})}})}),define("torii/providers/github-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"github-oauth2",baseUrl:"https://github.com/login/oauth/authorize",responseParams:["code","state"],redirectUri:e("redirectUri",function(){return this._super()})});c["default"]=f}),define("torii/providers/google-oauth2-bearer",["torii/providers/oauth2-bearer","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"google-oauth2-bearer",baseUrl:"https://accounts.google.com/o/oauth2/auth",optionalUrlParams:["scope","request_visible_actions"],requestVisibleActions:e("requestVisibleActions",""),responseParams:["access_token"],scope:e("scope","email"),redirectUri:e("redirectUri","http://localhost:8000/oauth2callback")});c["default"]=f}),define("torii/providers/google-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"google-oauth2",baseUrl:"https://accounts.google.com/o/oauth2/auth",optionalUrlParams:["scope","request_visible_actions","access_type","approval_prompt","hd"],requestVisibleActions:e("requestVisibleActions",""),accessType:e("accessType",""),responseParams:["code","state"],scope:e("scope","email"),approvalPrompt:e("approvalPrompt","auto"),redirectUri:e("redirectUri","http://localhost:8000/oauth2callback"),hd:e("hd","")});c["default"]=f}),define("torii/providers/linked-in-oauth2",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable,f=d.extend({name:"linked-in-oauth2",baseUrl:"https://www.linkedin.com/uas/oauth2/authorization",responseParams:["code","state"],redirectUri:e("redirectUri",function(){return this._super()})});c["default"]=f}),define("torii/providers/oauth1",["torii/providers/base","torii/configuration","torii/lib/query-string","torii/lib/required-property","exports"],function(a,b,c,d,e){"use strict";var f=a["default"],g=b.configurable,h=(c["default"],d["default"],f.extend({name:"oauth1",requestTokenUri:g("requestTokenUri"),buildRequestTokenUrl:function(){var a=this.get("requestTokenUri");return a},open:function(){var a=this.get("name"),b=this.buildRequestTokenUrl();return this.get("popup").open(b,["code"]).then(function(b){return b.provider=a,b})}}));e["default"]=h}),define("torii/providers/oauth2-bearer",["torii/providers/oauth2-code","exports"],function(a,b){"use strict";var c=a["default"],d=c.extend({responseType:"token",open:function(){var a=this.get("name"),b=this.buildUrl(),c=this.get("redirectUri"),d=this.get("responseParams");return this.get("popup").open(b,d).then(function(b){var e=[];if(d.forEach(function(a){void 0===b[a]&&e.push(a)}),e.length)throw new Error("The response from the provider is missing these required response params: "+e.join(", "));return{authorizationToken:b,provider:a,redirectUri:c}})}});b["default"]=d}),define("torii/providers/oauth2-code",["torii/providers/base","torii/configuration","torii/lib/query-string","torii/lib/required-property","torii/lib/random-url-safe","exports"],function(a,b,c,d,e,f){"use strict";function g(){return[window.location.protocol,"//",window.location.host,window.location.pathname].join("")}var h=a["default"],i=b.configurable,j=c["default"],k=d["default"],l=e["default"],m=Ember.computed,n=h.extend({concatenatedProperties:["requiredUrlParams","optionalUrlParams"],requiredUrlParams:["response_type","client_id","redirect_uri","state"],optionalUrlParams:["scope"],baseUrl:k(),apiKey:i("apiKey"),scope:i("scope",null),clientId:i("clientId",function(){return this.get("apiKey")}),state:i("state",function(){return this.get("randomState")}),_randomState:null,randomState:m("_randomState",function(){var a=this.get("_randomState");return a||(a=l(16),this.set("_randomState",a)),a}),responseType:"code",responseParams:k(),redirectUri:m(function(){return g()}),buildQueryString:function(){var a=this.get("requiredUrlParams"),b=this.get("optionalUrlParams"),c=j.create({provider:this,requiredParams:a,optionalParams:b});return c.toString()},buildUrl:function(){var a=this.get("baseUrl"),b=this.buildQueryString();return[a,b].join("?")},open:function(){var a=this.get("name"),b=this.buildUrl(),c=this.get("redirectUri"),d=this.get("responseParams"),e=this.get("responseType"),f=this.get("state"),g=-1!==d.indexOf("state");return this.get("popup").open(b,d).then(function(b){var h=[];if(d.forEach(function(a){void 0===b[a]&&h.push(a)}),h.length)throw new Error("The response from the provider is missing these required response params: "+h.join(", "));if(g&&b.state!==f)throw new Error('The response from the provider has an incorrect session state param: should be "'+f+'", but is "'+b.state+'"');return{authorizationCode:b[e],provider:a,redirectUri:c}})}});f["default"]=n}),define("torii/providers/stripe-connect",["torii/providers/oauth2-code","torii/configuration","exports"],function(a,b,c){"use strict";var d=a["default"],e=b.configurable;c["default"]=d.extend({name:"stripe-connect",baseUrl:"https://connect.stripe.com/oauth/authorize",requiredUrlParams:[],optionalUrlParams:["stripe_landing","always_prompt"],responseParams:["code","state"],scope:e("scope","read_write"),stripeLanding:e("stripeLanding",""),alwaysPrompt:e("alwaysPrompt","false"),redirectUri:e("redirectUri",function(){return this._super()})})}),define("torii/providers/twitter-oauth1",["torii/providers/oauth1","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=c.extend({name:"twitter"})}),define("torii/redirect-handler",["./lib/popup-id-serializer","./services/popup","exports"],function(a,b,c){"use strict";var d=(a["default"],b.CURRENT_REQUEST_KEY),e=Ember.Object.extend({run:function(){var a=this.windowObject;return new Ember.RSVP.Promise(function(b,c){var e=a.localStorage.getItem(d);if(a.localStorage.removeItem(d),e){var f=a.location.toString();a.localStorage.setItem(e,f),a.close()}else c("Not a torii popup")})}});e.reopenClass({handle:function(a){var b=e.create({windowObject:a});return b.run()}}),c["default"]=e}),define("torii/router-dsl-ext",[],function(){"use strict";var a=Ember.Router,b=Ember.RouterDSL.prototype,c=null;b.authenticatedRoute=function(){this.route.apply(this,arguments),c.push(arguments[0])},a.reopen({_initRouterJs:function(){c=[],this._super.apply(this,arguments),this.router.authenticatedRoutes=c}})}),define("torii/routing/application-route-mixin",["torii/configuration","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=Ember.Mixin.create({beforeModel:function(a){var b=this,c=this._super.apply(this,arguments);return c&&c.then?c.then(function(){return b.checkLogin(a)}):b.checkLogin(a)},checkLogin:function(){return this.get(c.sessionServiceName).fetch()["catch"](function(){})}})}),define("torii/routing/authenticated-route-mixin",["torii/configuration","exports"],function(a,b){"use strict";var c=a["default"];b["default"]=Ember.Mixin.create({beforeModel:function(a){var b=this,c=this._super.apply(this,arguments);return c&&c.then?c.then(function(){return b.authenticate(a)}):b.authenticate(a)},authenticate:function(a){var b=this,d=this.get(c.sessionServiceName),e=this.get(c.sessionServiceName+".isAuthenticated"),f=void 0!==e;return e?Ember.RSVP.resolve():(d.attemptedTransition=a,f?b.accessDenied(a):d.fetch()["catch"](function(){return b.accessDenied(a)}))},accessDenied:function(a){a.send("accessDenied")}})}),define("torii/services/popup",["torii/lib/parse-query-string","torii/lib/uuid-generator","torii/lib/popup-id-serializer","exports"],function(a,b,c,d){"use strict";function e(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d;switch(a[c]){case!0:d="1";break;case!1:d="0";break;default:d=a[c]}b.push(c+"="+d)}return b.join(",")}function f(a){var b=a.width||500,c=a.height||500;return Ember.$.extend({left:screen.width/2-b/2,top:screen.height/2-c/2,width:b,height:c},a)}function g(a,b){var c=h.create({url:a,keys:b}),d=c.parse();return d}var h=a["default"],i=b["default"],j=c["default"],k="__torii_request";d.CURRENT_REQUEST_KEY=k;var l=Ember.on,m=Ember.Object.extend(Ember.Evented,{init:function(){this.popupIdGenerator=this.popupIdGenerator||i},open:function(a,b,c){var d=this,h=this.popup;return new Ember.RSVP.Promise(function(i,l){h&&d.close();var m=d.popupIdGenerator.generate(),n=e(f(c||{})),o=j.serialize(m);return localStorage.setItem(k,o),d.popup=window.open(a,o,n),!d.popup||d.popup.closed?void l(new Error("Popup could not open or was closed")):(d.popup.focus(),d.one("didClose",function(){var a=localStorage.getItem(k);a&&(localStorage.removeItem(a),localStorage.removeItem(k)),d.timeout=Ember.run.later(d,function(){l(new Error("Popup was closed, authorization was denied, or a authentication message otherwise not received before the window closed."))},100)}),Ember.$(window).on("storage.torii",function(a){var c=a.originalEvent,d=j.deserialize(c.key);if(m===d){var e=g(c.newValue,b);localStorage.removeItem(c.key),Ember.run(function(){i(e)})}}),void d.schedulePolling())})["finally"](function(){d.close(),d.clearTimeout(),Ember.$(window).off("storage.torii")})},close:function(){this.popup&&(this.popup=null,this.trigger("didClose"))},pollPopup:function(){this.popup&&this.popup.closed&&this.trigger("didClose")},schedulePolling:function(){this.polling=Ember.run.later(this,function(){this.pollPopup(),this.schedulePolling()},35)},clearTimeout:function(){Ember.run.cancel(this.timeout),this.timeout=null},stopPolling:l("didClose",function(){Ember.run.cancel(this.polling)})});d["default"]=m}),define("torii/services/torii-session",["torii/session/state-machine","exports"],function(a,b){"use strict";function c(a,b){var c=a.lookup("torii-adapter:"+b);return c||(c=a.lookup("torii-adapter:application")),c}var d=a["default"],e=Ember.computed,f=Ember.on;b["default"]=Ember.Service.extend(Ember._ProxyMixin,{state:null,stateMachine:e(function(){return d(this)}),setupStateProxy:f("init",function(){var a=this.get("stateMachine"),b=this;a.on("didTransition",function(){b.set("content",a.state),b.set("currentStateName",a.currentStateName)})}),setUnknownProperty:Ember.K,open:function(a,b){var d=this.container,e=this.get("torii"),f=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){f.send("startOpen"),a()}).then(function(){return e.open(a,b)}).then(function(b){var e=c(d,a);return e.open(b)}).then(function(a){return f.send("finishOpen",a),a})["catch"](function(a){return f.send("failOpen",a),Ember.RSVP.reject(a)})},fetch:function(a,b){var d=this.container,e=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){e.send("startFetch"),a()}).then(function(){var e=c(d,a);return e.fetch(b)}).then(function(a){e.send("finishFetch",a)})["catch"](function(a){return e.send("failFetch",a),Ember.RSVP.reject(a)})},close:function(a,b){var d=this.container,e=this.get("stateMachine");return new Ember.RSVP.Promise(function(a){e.send("startClose"),a()}).then(function(){var e=c(d,a);return e.close(b)}).then(function(){e.send("finishClose")})["catch"](function(a){return e.send("failClose",a),Ember.RSVP.reject(a)})}})}),define("torii/services/torii",["exports"],function(a){"use strict";function b(a,b){return a.lookup("torii-provider:"+b)}function c(a,c){return function(d,e){var f=this.container,g=b(f,d);if(!g)throw new Error("Expected a provider named '"+d+"' , did you forget to register it?");if(!g[a]){if(c)throw new Error("Expected provider '"+d+"' to define the '"+a+"' method.");return Ember.RSVP.Promise.resolve({})}return new Ember.RSVP.Promise(function(b,c){b(g[a](e))})}}a["default"]=Ember.Service.extend({open:c("open",!0),fetch:c("fetch"),close:c("close")})}),define("torii/session/state-machine",["torii/lib/state-machine","exports"],function(a,b){"use strict";function c(a,b){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}function d(a,b){return function(){for(var c;c<b.length;c++)this[b[c]]=null;this.transitionTo(a)}}var e=a["default"],f=e.transitionTo;b["default"]=function(a){var b=new e({initialState:"unauthenticated",states:{unauthenticated:{errorMessage:null,isAuthenticated:!1,startOpen:d("opening",["errorMessage"]),startFetch:d("fetching",["errorMessage"])},authenticated:{currentUser:null,isAuthenticated:!0,startClose:f("closing")},opening:{isWorking:!0,isOpening:!0,finishOpen:function(a){c(a,this.states.authenticated),this.transitionTo("authenticated")},failOpen:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}},fetching:{isWorking:!0,isFetching:!0,finishFetch:function(a){c(a,this.states.authenticated),this.transitionTo("authenticated")},failFetch:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}},closing:{isWorking:!0,isClosing:!0,isAuthenticated:!0,finishClose:function(){this.transitionTo("unauthenticated")},failClose:function(a){this.states.unauthenticated.errorMessage=a,this.transitionTo("unauthenticated")}}}});return b.session=a,b}});